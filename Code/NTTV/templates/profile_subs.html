<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>NTTV ‚Äì –ü—ñ–¥–ø–∏—Å–∫–∏</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1119387653458763"
     crossorigin="anonymous"></script>
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
</head>
<body>
<header>
    <h1>NTTV</h1>
    <p class="subtitle_s">NextTheme.TV ‚Äì –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ç–µ–º, —Ç–≤–æ—Ä—á–æ—Å—Ç—ñ —Ç–∞ —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è</p>
    <nav>
        <a href="{{ url_for('forums') }}">–¢–µ–º–∏</a>
        <a href="{{ url_for('profile') }}">–ü—Ä–æ—Ñ—ñ–ª—å</a>
        <a href="{{ url_for('index') }}">–ì–æ–ª–æ–≤–Ω–∞</a>
    </nav>
</header>

<section class="forum-list">
    <ul>
        
        {% if subs %}
        
            {% for forum_id, forum in subs.items() %}
                <li class="post">
                    <div class="post-content">
                        <h3>{{ forum['name'] }}</h3>
                        <h4>–ü—ñ–¥–ø–∏—Å–Ω–∏–∫–∏: {{ get_subscriber_count(forum_id) }}</h4>
                        <h5>–†–µ–ø: {{ forum['reputation'] }}</h5>
                        <p>{{ forum['description'] }}</p>
                        <div class="author">–ê–≤—Ç–æ—Ä:
                            {% set author = users.get(forum['author_id']) %}
                            {{ author['username'] if author else '???' }}
                        </div>
                        <a href="{{ url_for('view_forum', forum_id=forum_id) }}">üîç –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏</a>
                    </div>

                    {% if show_menu == forum_id %}
                        <div class="admin-menu">
                            {% if session['user_id'] == forum['author_id'] or 'admin' in session.get('roles', []) %}
                                <form action="/forums/delete/{{ forum_id }}" method="POST" onsubmit="return confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π —Ñ–æ—Ä—É–º?')">
                                    <button type="submit" style="color: red;">–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–µ–º—É</button>
                                </form>
                                <form action="/forums/edit/{{ forum_id }}" method="GET">
                                    <button type="submit">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                                </form>
                            {% endif %}
                        </div>
                    {% endif %}

                    {% if 'user_id' in session %}
                        {% if session['user_id'] not in forum['subscribers'] %}
                            <form action="/forums/subscribe/{{ forum_id }}" method="POST">
                                <button type="submit">–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è</button>
                            </form>
                        {% else %}
                            <form action="/forums/unsubscribe/{{ forum_id }}" method="POST">
                                <button type="submit">–í—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è</button>
                            </form>
                        {% endif %}

                        {% if session['user_id'] == forum['author_id'] %}
                            <form action="/forums/moderate/{{ forum_id }}" method="GET">
                                <button type="submit">–ö–µ—Ä—É–≤–∞—Ç–∏</button>
                            </form>
                        {% endif %}
                    {% else %}
                        <p>–î–ª—è –ø—ñ–¥–ø–∏—Å–∫–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ <a href="{{ url_for('login') }}">—É–≤—ñ–π—Ç–∏</a>.</p>
                    {% endif %}
                </li>
            {% endfor %}
        {% else %}
            <p class="subtitle_s">–í–∏ —â–µ –Ω–µ –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ –Ω–∞ –∂–æ–¥–µ–Ω —Ñ–æ—Ä—É–º.</p>
            <p class="subtitle_s">–°–∞–º–µ —á–∞—Å —Ü–µ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏...</p>
        {% endif %}
    </ul>
</section>


</body>
</html